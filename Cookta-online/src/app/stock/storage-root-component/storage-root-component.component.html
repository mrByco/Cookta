<div class="container-fluid" >
    <div class="row">
        <div class="col-md"></div>
        <div class="col-md-9">
            <mat-tab-group color="accent" style="height: var(--MainContentSize)">
                <mat-tab [label]="section.GetDisplayName()" *ngFor="let section of stockService.Sections">
                    <app-storage-section
                            [SelectedItems]="SelectedItems" [CurrentSection]="section"></app-storage-section>
                </mat-tab>
            </mat-tab-group>
        </div>
        <div class="col-md"></div>
    </div>
</div>
<button style="position: absolute; right: 2rem; bottom: 2rem;" mdbBtn size="small" color="blue"
        [disabled]="ButtonLoading"
        (click)="AddNewSection()">
    {{ButtonLoading ? '' : 'Új szekció'}}

    <div *ngIf="ButtonLoading" class="spinner-border text-light" role="status">
        <span class="sr-only">Loading...</span>
    </div>
</button>
<div class="" style="position: absolute; right: 2rem; top: 7rem;">
    <div class="row">
        <button mdbBtn size="small" color="green"
                (click)="ShowAddModal()">
            Mit vettél?
        </button>
    </div>
    <div class="row">
        <button mdbBtn size="small" color="orange"
                (click)="RemoveIngModal.show()">
            Mit vittél?
        </button>
    </div>
</div>


<div mdbModal #AddIngModal class="modal fade right" tabindex="-1" role="dialog" aria-hidden="true"
     [config]="{backdrop: true, ignoreBackdropClick: true}">
    <div class="modal-dialog modal-side modal-top-right" role="document">
        <div class="modal-content">
            <div class="modal-header">
                <button type="button" class="close pull-right" aria-label="Close" (click)="AddIngModal.hide()">
                    <span aria-hidden="true">×</span>
                </button>
                <h4 class="modal-title w-100" id="addIngTitle">Mit vettél?</h4>
            </div>
            <div class="modal-body">
                <app-ingredient-adder
                    #ingredientAdder
                    (OnIngredientAdded)="AddIngredientToSection($event)">
                </app-ingredient-adder>
                <hr>
                <a *ngIf="ingredientAdder.CurrentType != null && stockService.FindStorageByIngredientType(ingredientAdder.CurrentType.guid) &&
             ingredientAdder.CurrentType != null && stockService.FindStorageByIngredientType(ingredientAdder.CurrentType.guid) != SelectedSection"
                   (click)="SelectedSection = ingredientAdder.CurrentType != null && stockService.FindStorageByIngredientType(ingredientAdder.CurrentType.guid)"
                   style="color: dodgerblue; margin-bottom: 1rem">
                    `Ez már be van
                    írva: {{stockService.FindStorageByIngredientType(ingredientAdder.CurrentType.guid).GetDisplayName()}}
                    -tárolóba,
                    kattints ide átváltáshoz
                </a>
                <div class="row">
                    <div class="col-auto">
                        <h6 style="margin-top: 10px">Pakolás helye: </h6>
                    </div>
                    <div class="col">
                        <select class="browser-default custom-select " style="width: 100%"
                                [(ngModel)]="this.SelectedSection">
                            <option *ngFor="let section of stockService.Sections"
                                    [selected]="SelectedSection == section"
                                    [ngValue]="section">
                                {{section.GetDisplayName()}}
                            </option>
                        </select>
                    </div>
                </div>
            </div>
        </div>
    </div>
</div>

<div mdbModal #RemoveIngModal class="modal fade right" tabindex="-1" role="dialog" aria-hidden="true"
     [config]="{backdrop: true, ignoreBackdropClick: true}">
    <div class="modal-dialog modal-side modal-top-right" role="document">
        <div class="modal-content">
            <div class="modal-header">
                <button type="button" class="close pull-right" aria-label="Close" (click)="RemoveIngModal.hide()">
                    <span aria-hidden="true">×</span>
                </button>
                <h4 class="modal-title w-100" id="removeIngTitle">Mit bontottál ki?</h4>
            </div>
            <div class="modal-body">
                <app-ingredient-adder
                        [ShowAddButton]="false"
                        #IngredientRemover
                        (OnIngredientChangedProgrammatically)="CloseIfIngredientIsZero($event, RemoveIngModal)"
                        (OnIngredientAdded)="AddIngredientToSection($event)">
                </app-ingredient-adder>
                <hr>
                <div
                        *ngIf="IngredientRemover.Done">
                    <div *ngFor="let section of findStorageSectionsByType(IngredientRemover.CurrentType.guid)"
                         style="position: static">
                        <div class="row" *ngFor="let ing of section.filterItemsByIngId(IngredientRemover.CurrentType)"
                             style="position: static">
                            <div class="col-8">
                                {{section.GetDisplayName()}}
                            </div>
                            <div class="col-auto mx-0 px-0">
                                {{ing.value}}
                            </div>
                            <div class="col mx-0 px-0">
                                {{unitService.GetDisplayName(ing.unit)}}
                            </div>
                            <div class="col-2 mr-3">
                                <a (click)="IngredientRemover.Ingredient = stockService.SubtractIngredientFromSection(IngredientRemover.Ingredient, section, true)"
                                   class="take-off">Levon</a>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>
</div>



